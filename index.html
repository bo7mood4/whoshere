<!DOCTYPE html>
<html>
    <head>
        <link rel = "stylesheet" href = "css/main.css">
        <link rel= "stylesheet" href = "css/cube.css">
        <script src = "libraries/jquery.js"></script>
        <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyB10Aj7W330jXyK80bF-U3V0OXMyLm0zyY&sensor=false"></script>
        <script>
            start = undefined;
            end = undefined;
            prevSide = "";
            pageNavigation = {
                map: {"script" : "views/whoshere.js", "view" : "views/whoshere.html", "css":".front" ,"cssTransition" : "show-front", "loaded" : false, "start" : start, "end" : end},
                login : {"script" : "views/login.js", "view" : "views/login.html", "css" : ".left", "cssTransition" : "show-left", "loaded" : false},
                logout : {"script" : "views/logout.js", "view" : "views/logout.html", "css" : ".right", "cssTransition" : "show-right", "loaded" : false},
            }
            
            $(function(){
                $("#login").click(function(){
                   show("login");
                });
                $("#logout").click(function(){
                   show("logout");
                });
                
                $.get("scripts/hassession.php",function(data){//if session var is already there
                    console.log(data);
                    if (data == "0"){
                        show("login");
                    }
                    else if (data == "1"){
                        show("map");
                    }
                });
            });
            
            function show(name){
                if (pageNavigation[prevSide]){
                    console.log("there was a previous slide");
                    console.log(typeof pageNavigation[prevSide].end)
                    $("#cube").removeClass(pageNavigation[prevSide].cssTransition);
                    if (typeof pageNavigation[prevSide].end === "function")pageNavigation[prevSide].end();
                }
                
                $("#cube").addClass(pageNavigation[name].cssTransition);
                if (!pageNavigation[name]["loaded"]){
                    $.get(pageNavigation[name].view,function(data){
                        console.log(data);
                        $(pageNavigation[name].css).empty().append(data);//hack, try not loading
                        pageNavigation[name]["loaded"]=true;
                        $.getScript(pageNavigation[name].script,function(){//shitty for now, but we can do caching later
                            if (typeof pageNavigation[name].start === "function")pageNavigation[name].start();
                        });
                    });
                }
                prevSide = name;
            }
        </script>
    </head>
    <body>
        <div id = "message"></div>
        <section class="container">
          <div id="cube">
            <figure class="front"></figure>
            <figure class="back"></figure>
            <figure class="right"></figure>
            <figure class="left"></figure>
            <figure class="top"></figure>
            <figure class="bottom"></figure>
          </div>
        </section>
        <div id = "footer">
            <button id = "login">login</button>
            <button id = "logout">logout</button>
        </div>
    </body>
</html>
